"use strict";function loadSounds(t){var e;t.length;for(e in t)t.hasOwnProperty(e)&&loadSoundObj(t[e])}function loadSoundObj(t){var e=new XMLHttpRequest;e.open("GET",t.src+format,!0),e.responseType="arraybuffer",e.onload=function(){audioCtx.decodeAudioData(e.response,function(e){t.buffer=e},function(t){throw new Error(t)})}}function playSound(t){var e=audioCtx.createBufferSource();e.buffer=t,e.connect(audioCtx.destination)}function getWidth(){return window.innerWidth>1300?1300:window.innerWidth}function scaleImages(t){var e=t.width/t.height;w=canvas.width,h=canvas.width/e}function draw(){rect=canvas.getBoundingClientRect(),ctx.drawImage(night,0,0,w,h),drawClip(mouse.x,mouse.y),setTimeout(draw,20)}function drawClip(t,e){ctx.drawImage(night,0,0,w,h),sctx.clearRect(0,0,scratchCanvas.width,scratchCanvas.height),sctx.globalCompositeOperation="source-over",sctx.drawImage(day,0,0,w,h),sctx.fillStyle="#fff",sctx.globalCompositeOperation="destination-in",sctx.beginPath(),sctx.arc(t,e,clipRadius,0,2*Math.PI,!0),sctx.closePath(),sctx.fill(),ctx.drawImage(scratchCanvas,0,0)}function redraw(){ctx.canvas.width=getWidth(),ctx.canvas.height=h,clipRadius=.04*canvas.width}function setupMouse(t,e,n){function a(t){mouse.x=t.clientX-rect.left,mouse.y=t.clientY-rect.top,e(mouse.x,mouse.y)}var i=t.addEventListener.bind(t);i("mousemove",a)}function init(){4===day.readyState?(scaleImages(imageNight),draw(),$(".loader").addClass("done")):setTimeout(init,100)}var audioFiles={owl:{}};window.AudioContext=window.AudioContext||window.webkitAudioContext;var audioCtx=new AudioContext,test,request=new XMLHttpRequest;request.open("GET","assets/audio/horned-owl.mp3",!0),request.responseType="arraybuffer",request.onload=function(){audioCtx.decodeAudioData(request.response,function(t){test=t,playSound(test)},function(t){throw new Error(t)})},request.send();var canvas=document.getElementById("forest"),ctx=canvas.getContext("2d"),scratchCanvas=document.createElement("canvas"),sctx=scratchCanvas.getContext("2d"),day=document.getElementById("day"),night=document.getElementById("night"),rect=null,imageNight=new Image,w=0,h=0,clipRadius=50,mouse={x:-200,y:-200};setupMouse(canvas,drawClip,!0),ctx.canvas.width=getWidth(),ctx.canvas.height=window.innerHeight,scratchCanvas.width=canvas.width,scratchCanvas.height=canvas.height,window.onresize=redraw,imageNight.src="assets/img/night.png";var theme=document.getElementById("theme");$(".start").click(function(){$("#landing").fadeOut(800),$("#game").addClass("running"),theme.play(),init()}),$(".volume").click(function(){$(this).toggleClass("muted"),theme.muted=!theme.muted}),function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],a=n.length,i=window.console=window.console||{};a--;)t=n[a],i[t]||(i[t]=e)}();